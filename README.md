# PowerShell скрипт для массового создания локальных пользователей

Этот скрипт автоматизирует процесс создания локальных пользователей на Windows Server из текстового файла, а также позволяет управлять их членством в группах и политикой смены пароля.

## Возможности

*   **Массовое создание:** Создает пользователей из простого текстового файла (`имя<ТАБ>пароль`).
*   **Членство в группах:** Автоматически добавляет созданных пользователей в одну или несколько указанных локальных групп.
*   **Управление сменой пароля:** Позволяет выбрать, должен ли пользователь сменить пароль при первом входе, или пароль будет постоянным.
*   **Информативный вывод:** Показывает в консоли подробный статус по каждому создаваемому пользователю.
*   **Проверка на дубликаты:** Не пытается создать пользователя, если он уже существует.

## Требования

*   Windows Server 2016 / 2019 / 2022 или Windows 10 / 11 Pro.
*   PowerShell 5.1 или выше.
*   Скрипт должен запускаться от имени **Администратора**.

## Подготовка

1.  Сохраните код скрипта в файл с именем `Create-Users.ps1`.
2.  Или скачайте:
```
curl https://raw.githubusercontent.com/DIMNISSV/win-create-users/refs/heads/master/Create-Users.ps1 -o Create-Users.ps1
```
3.  Создайте текстовый файл (например, `users.txt`) для списка пользователей.
4.  Заполните файл данными в формате **`имя_пользователя<ТАБУЛЯЦИЯ>пароль`**. Каждый новый пользователь должен быть на новой строке.

    **Пример содержимого `users.txt`:**
    ```
    akovalenko	TempPass_!2025
    dpetrov		SecretWord#987
    mivanova	Another$ecretPa$$
    ```
    **Внимание:** Убедитесь, что между именем и паролем используется именно символ табуляции (клавиша `Tab`), а не пробелы.

## Использование

Скрипт запускается из консоли PowerShell и принимает три параметра:

| Параметр              | Описание                                                                                                   | Обязательный | Пример значения                                  |
| --------------------- | ---------------------------------------------------------------------------------------------------------- | -------------- | ------------------------------------------------ |
| `-PathToFile`         | Полный путь к вашему текстовому файлу с пользователями.                                                    | **Да**         | `"C:\data\users.txt"`                            |
| `-Groups`             | Список групп через запятую, в которые нужно добавить пользователей.                                        | Нет            | `"Remote Desktop Users", "Power Users"`          |
| `-ForcePasswordChange`| Установить требование смены пароля при первом входе. По умолчанию `$true` (требовать смену).               | Нет            | `$false`                                         |

### Примеры команд

**1. Создать пользователей и потребовать смену пароля (поведение по умолчанию):**
```powershell
.\Create-Users.ps1 -PathToFile "C:\data\users.txt" -Groups "Remote Desktop Users"
```

**2. Создать пользователей с постоянными паролями (смена не требуется):**
```powershell
.\Create-Users.ps1 -PathToFile "C:\data\users.txt" -Groups "Remote Desktop Users" -ForcePasswordChange:$false
```

**3. Создать пользователей и добавить их в несколько групп:**
```powershell
.\Create-Users.ps1 -PathToFile "C:\data\users.txt" -Groups "Remote Desktop Users", "Backup Operators"
```
*Или, если на русском:* `"Пользователи удаленного рабочего стола"`

**4. Просто создать пользователей без добавления в группы и с требованием смены пароля:**
```powershell
.\Create-Users.ps1 -PathToFile "C:\data\users.txt"
```
